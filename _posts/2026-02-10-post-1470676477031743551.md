---
layout: post
title: "```"
date: 2026-02-10 16:03:15 +0900
categories: [DiscordLog]
tags: [til, dev]
---

```
#Requires AutoHotkey v2.0
#SingleInstance Force

; Esc 키 매핑 ($는 무한 루프 방지)
$Esc::
{
    ; 현재 활성 창("A")의 한글 입력 상태 확인
    if (IME_Check("A"))
    {
        ; 한글이면 한/영키(vk15)를 눌러 영어로 전환
        Send("{vk15}")
    }

    ; 원래 Esc 키 기능 실행 (창 닫기 등)
    ; Esc 기능은 끄고 싶으면 아래 줄을 지우세요.
    Send("{Esc}")
}

; --- IME 상태 확인 함수 (v2 전용) ---
IME_Check(WinTitle)
{
    try
    {
        hWnd := WinGetID(WinTitle)
    }
    catch
    {
        return False ; 창을 찾지 못하면 거짓 반환
    }

    ; IME 윈도우 핸들 가져오기
    DefaultIMEWnd := DllCall("imm32\ImmGetDefaultIMEWnd", "Ptr", hWnd, "Ptr")

    ; 숨겨진 창 감지 켜기 (IME 창은 숨겨져 있으므로 필수)
    DetectHiddenWindows(True)

    ; IMC_GETOPENSTATUS (0x005) 메시지 전송
    ; 반환값: 0 (영어), 0이 아님 (한글)
    Result := SendMessage(0x283, 0x005, 0, , "ahk_id " . DefaultIMEWnd)

    ; 감지 설정 복구
    DetectHiddenWindows(False)

    return Result
}
```
